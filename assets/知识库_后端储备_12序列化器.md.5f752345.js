import{_ as n,c as s,o as a,b as e}from"./app.bc4d709e.js";const d='{"title":"12,\u5E8F\u5217\u5316\u5668\u6982\u8FF0(\u4E86\u89E3)","description":"","frontmatter":{},"headers":[],"relativePath":"\u77E5\u8BC6\u5E93/\u540E\u7AEF\u50A8\u5907/12\u5E8F\u5217\u5316\u5668.md","lastUpdated":1643983969049}',p={},o=e(`<h4 id="_12-\u5E8F\u5217\u5316\u5668\u6982\u8FF0-\u4E86\u89E3" tabindex="-1">12,\u5E8F\u5217\u5316\u5668\u6982\u8FF0(\u4E86\u89E3) <a class="header-anchor" href="#_12-\u5E8F\u5217\u5316\u5668\u6982\u8FF0-\u4E86\u89E3" aria-hidden="true">#</a></h4><ul><li>\u76EE\u7684: \u77E5\u9053\u5E8F\u5217\u5316\u5668\u7684\u4F5C\u7528</li><li>\u5E8F\u5217\u5316\u5668\u7684\u4F5C\u7528: <ul><li>1, \u53CD\u5E8F\u5217\u5316: \u628Ajson(dict), \u8F6C\u6210\u6A21\u578B\u7C7B\u5BF9\u8C61 (\u6821\u9A8C,\u5165\u5E93)</li><li>2, \u5E8F\u5217\u5316: \u5C06\u6A21\u578B\u7C7B\u5BF9\u8C61, \u8F6C\u6210json(dict)\u6570\u636E</li></ul></li></ul><h4 id="_13-\u5E8F\u5217\u5316\u5668\u5B9A\u4E49-\u638C\u63E1" tabindex="-1">13,\u5E8F\u5217\u5316\u5668\u5B9A\u4E49(\u638C\u63E1) <a class="header-anchor" href="#_13-\u5E8F\u5217\u5316\u5668\u5B9A\u4E49-\u638C\u63E1" aria-hidden="true">#</a></h4><ul><li><p>\u76EE\u7684: \u53EF\u4EE5\u5B9A\u4E49\u4E66\u7C4D\u7684\u5E8F\u5217\u5316\u5668</p></li><li><p>\u64CD\u4F5C\u6D41\u7A0B:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token triple-quoted-string string">&quot;&quot;&quot;
\u5B9A\u4E49\u5E8F\u5217\u5316\u5668:
1, \u5B9A\u4E49\u7C7B, \u7EE7\u627F\u81EASerializer
2, \u7F16\u5199\u5B57\u6BB5\u540D\u79F0, \u548C\u6A21\u578B\u7C7B\u4E00\u6837
3, \u7F16\u5199\u5B57\u6BB5\u7C7B\u578B, \u548C\u6A21\u578B\u7C7B\u4E00\u6837
4, \u7F16\u5199\u5B57\u6BB5\u9009\u9879, \u548C\u6A21\u578B\u7C7B\u4E00\u6837
    read_only: \u53EA\u8BFB
    label: \u5B57\u6BB5\u8BF4\u660E

\u5E8F\u5217\u5316\u5668\u4F5C\u7528:
1, \u53CD\u5E8F\u5217\u5316: \u5C06json(dict)\u6570\u636E, \u8F6C\u6210\u6A21\u578B\u7C7B\u5BF9\u8C61
    \u2460: \u6821\u9A8C
    \u2461: \u5165\u5E93
    
2, \u5E8F\u5217\u5316: \u5C06\u6A21\u578B\u7C7B\u5BF9\u8C61, \u8F6C\u6210json(dict)\u6570\u636E
&quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token comment">#1,\u5B9A\u4E49\u4E66\u7C4D\u5E8F\u5217\u5316\u5668</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;\u4E66\u7C4D\u7F16\u53F7&quot;</span><span class="token punctuation">)</span>
    btitle <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;\u540D\u79F0&quot;</span><span class="token punctuation">)</span>
    bpub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&quot;\u53D1\u5E03\u65E5\u671F&quot;</span><span class="token punctuation">)</span>
    bread <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;\u9605\u8BFB\u91CF&quot;</span><span class="token punctuation">)</span>
    bcomment <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;\u8BC4\u8BBA\u91CF&quot;</span><span class="token punctuation">)</span>
    is_delete <span class="token operator">=</span> serializers<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;\u903B\u8F91\u5220\u9664&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></li></ul><h4 id="_14-\u5E8F\u5217\u5316\u5668-\u5E8F\u5217\u5316\u5355\u4E2A\u5BF9\u8C61-\u638C\u63E1" tabindex="-1">14,\u5E8F\u5217\u5316\u5668,\u5E8F\u5217\u5316\u5355\u4E2A\u5BF9\u8C61(\u638C\u63E1) <a class="header-anchor" href="#_14-\u5E8F\u5217\u5316\u5668-\u5E8F\u5217\u5316\u5355\u4E2A\u5BF9\u8C61-\u638C\u63E1" aria-hidden="true">#</a></h4><ul><li><p>\u76EE\u7684: \u53EF\u4EE5\u5C06\u5355\u672C\u6570\u636E\u4F7F\u7528\u5E8F\u5217\u5316\u5668, \u8F6C\u6210json(dict)\u6570\u636E</p></li><li><p>\u64CD\u4F5C\u6D41\u7A0B:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,\u83B7\u53D6\u4E66\u7C4D\u5BF9\u8C61</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">#2,\u521B\u5EFA\u5E8F\u5217\u5316\u5668\u5BF9\u8C61, instance=book \u8868\u793A\u5C06\u54EA\u4E00\u672C\u6570\u636E\u8FDB\u884C\u5E8F\u5217\u5316</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>

<span class="token comment">#3,\u8F93\u51FA\u5E8F\u5217\u5316\u4E4B\u540E\u7684\u7ED3\u679C</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
{&#39;id&#39;: 1, &#39;btitle&#39;: &#39;\u5C04\u96D5\u82F1\u96C4\u4F20&#39;, &#39;bpub_date&#39;: &#39;1980-05-01&#39;, &#39;bread&#39;: 12, &#39;bcomment&#39;: 34, &#39;is_delete&#39;: False}
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul><h4 id="_15-\u5E8F\u5217\u5316\u5668-\u5E8F\u5217\u5316\u5217\u8868\u6570\u636E-\u638C\u63E1" tabindex="-1">15,\u5E8F\u5217\u5316\u5668,\u5E8F\u5217\u5316\u5217\u8868\u6570\u636E(\u638C\u63E1) <a class="header-anchor" href="#_15-\u5E8F\u5217\u5316\u5668-\u5E8F\u5217\u5316\u5217\u8868\u6570\u636E-\u638C\u63E1" aria-hidden="true">#</a></h4><ul><li><p>\u76EE\u7684: \u53EF\u4EE5\u4F7F\u7528\u5E8F\u5217\u5316\u5668,\u5BF9\u5217\u8868\u4E2D\u7684\u591A\u4E2A\u5BF9\u8C61\u8FDB\u884C\u5E8F\u5217\u5316</p></li><li><p>\u64CD\u4F5C\u6D41\u7A0B:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,\u67E5\u8BE2\u6240\u6709\u7684\u4E66\u7C4D</span>
books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#2,\u521B\u5EFA\u5E8F\u5217\u5316\u5668\u5BF9\u8C61,many=True \u8868\u793A\u4F20\u5165\u7684\u662F\u5217\u8868\u5BF9\u8C61(\u591A\u4E2A\u6570\u636E)</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#3,\u8F93\u51FA\u5E8F\u5217\u5316\u7684\u7ED3\u679C</span>
serializer<span class="token punctuation">.</span>data
<span class="token triple-quoted-string string">&quot;&quot;&quot;
[
OrderedDict([(&#39;id&#39;, 1), (&#39;btitle&#39;, &#39;\u5C04\u96D5\u82F1\u96C4\u4F20&#39;), (&#39;bpub_date&#39;, &#39;1980-05-01&#39;), (&#39;bread&#39;, 12), (&#39;bcomment&#39;, 34), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39; (&#39;btitle&#39;, &#39;\u5929\u9F99\u516B\u90E8&#39;), (&#39;bpub_date&#39;, &#39;1986-07-24&#39;), (&#39;bread&#39;, 36), (&#39;bcomment&#39;, 40), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 3), (&#39;btitle&#39;, &#39;\u7B11\u50B2\u6C5F\u6E56&#39;), (&#39;bp, &#39;1995-12-24&#39;), (&#39;bread&#39;, 20), (&#39;bcomment&#39;, 80), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 4), (&#39;btitle&#39;, &#39;\u96EA\u5C71\u98DE\u72D0&#39;), (&#39;bpub_date&#39;, &#39;1987-11-11&#39;), (&#39;bread&#39;, 58&#39;bcomment&#39;, 24), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 6), (&#39;btitle&#39;, &#39;\u91D1\u74F6x2&#39;), (&#39;bpub_date&#39;, &#39;2019-01-01&#39;), (&#39;bread&#39;, 10), (&#39;bcomment&#39;, 5), (&#39;is_delete&#39;, Fse)])
]
&quot;&quot;&quot;</span>
<span class="token comment"># OrderedDict: \u6709\u5E8F\u5B57\u5178</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u6CE8\u610F\u70B9:</p><ul><li>serializer = BookSerializer(instance=books,many=True)</li><li>instance: \u9700\u8981\u5E8F\u5217\u5316\u7684\u5BF9\u8C61</li><li>many=True: \u9ED8\u8BA4\u662FNone, \u5982\u679C\u4F20\u5165True, \u9700\u8981\u5E8F\u5217\u5316\u7684\u5BF9\u8C61\u662F\u5217\u8868</li><li>serializer.data: \u8868\u793A\u8F93\u51FA\u5E8F\u5217\u5316\u4E4B\u540E\u7684\u7ED3\u679C</li></ul></li></ul><h4 id="_16-\u82F1\u96C4\u5E8F\u5217\u5316\u5668\u5173\u8054\u5916\u952E-\u638C\u63E1" tabindex="-1">16,\u82F1\u96C4\u5E8F\u5217\u5316\u5668\u5173\u8054\u5916\u952E(\u638C\u63E1) <a class="header-anchor" href="#_16-\u82F1\u96C4\u5E8F\u5217\u5316\u5668\u5173\u8054\u5916\u952E-\u638C\u63E1" aria-hidden="true">#</a></h4><ul><li><p>\u76EE\u7684: \u53EF\u4EE5\u5C06\u5173\u8054\u82F1\u96C4\u7684\u4E66\u7C4D\u4FE1\u606F, \u4E09\u79CD\u5F62\u5F0F\u8868\u793A\u51FA\u6765</p></li><li><p>\u64CD\u4F5C\u6D41\u7A0B:</p><ul><li><p>1, \u5E8F\u5217\u5316\u5668</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#2,\u5B9A\u4E49\u82F1\u96C4\u5E8F\u5217\u5316\u5668</span>
<span class="token keyword">class</span> <span class="token class-name">HeroInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;\u82F1\u96C4\u6570\u636E\u5E8F\u5217\u5316\u5668&quot;&quot;&quot;</span>
    GENDER_CHOICES <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;male&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;female&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    hname <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;\u540D\u5B57&#39;</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    hgender <span class="token operator">=</span> serializers<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span>choices<span class="token operator">=</span>GENDER_CHOICES<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;\u6027\u522B&#39;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    hcomment <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;\u63CF\u8FF0\u4FE1\u606F&#39;</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> allow_null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment">#1,\u6DFB\u52A0\u5916\u952E,\u4E3B\u952E\u8868\u793A \u5FC5\u987B\u63D0\u4F9B\`queryset\` \u9009\u9879, \u6216\u8005\u8BBE\u7F6E read_only=\`True\`.</span>
    <span class="token comment"># queryset=BookInfo.objects.all()\u8868\u793A\u628A\u6240\u6709\u4E66\u7C4D\u5168\u90E8\u67E5\u51FA\u6765\u8BA9\u4ED6\u81EA\u5DF1\u53BB\u5339\u914D\u3002</span>
    
    <span class="token comment"># hbook = serializers.PrimaryKeyRelatedField(queryset=BookInfo.objects.all())</span>
    <span class="token comment"># hbook = serializers.PrimaryKeyRelatedField(read_only=True)</span>

    <span class="token comment">#2,\u6DFB\u52A0\u5916\u952E, \u6765\u81EA\u4E8E\u5173\u8054\u6A21\u578B\u7C7B, __str__\u7684\u8FD4\u56DE\u503C</span>
    <span class="token comment"># hbook = serializers.StringRelatedField(read_only=True)</span>

    <span class="token comment">#3,\u6DFB\u52A0\u5916\u952E,\u5173\u8054\u53E6\u5916\u4E00\u4E2A\u5E8F\u5217\u5316\u5668\uFF0C\u8FD4\u56DE\u6574\u672C\u4E66\u7684\u5168\u90E8\u4FE1\u606F\uFF08\u4E66\u5DF2\u7ECF\u5B9A\u4E49\u597D\u5E8F\u5217\u5316\u5668\uFF09</span>
    hbook <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li><li><p>2, \u7C7B\u89C6\u56FE</p><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot; ===============3, \u82F1\u96C4\u5E8F\u5217\u5316\u5668, \u5173\u8054\u5916\u952E ================= &quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> HeroInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> HeroInfoSerializer

<span class="token comment">#1,\u83B7\u53D6\u5355\u4E2A\u82F1\u96C4</span>
hero <span class="token operator">=</span> HeroInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">#2,\u521B\u5EFA\u82F1\u96C4\u5E8F\u5217\u5316\u5668</span>
serializer <span class="token operator">=</span> HeroInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>hero<span class="token punctuation">)</span>

<span class="token comment">#3,\u8F93\u51FA\u7ED3\u679C</span>
serializer<span class="token punctuation">.</span>data

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li></ul><h4 id="_17-\u4E66\u7C4D\u5E8F\u5217\u5316\u5668-\u5173\u8054many-\u638C\u63E1" tabindex="-1">17,\u4E66\u7C4D\u5E8F\u5217\u5316\u5668,\u5173\u8054many(\u638C\u63E1) <a class="header-anchor" href="#_17-\u4E66\u7C4D\u5E8F\u5217\u5316\u5668-\u5173\u8054many-\u638C\u63E1" aria-hidden="true">#</a></h4><ul><li><p>django\u5C0F\u590D\u4E60:</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># \u77E5\u9053\u4E00\u4E2A\u82F1\u96C4\uFF0C\u5982\u4F55\u67E5\u51FA\u8FD9\u4E2A\u82F1\u96C4\u6240\u5728\u7684\u4E66\u7C4D</span>
hero <span class="token operator">=</span> HeroInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
hero<span class="token punctuation">.</span>hbook
<span class="token comment"># \u53CD\u8FC7\u6765\uFF0C\u77E5\u9053\u4E00\u672C\u4E66\uFF0C\u5982\u4F55\u67E5\u51FA\u8FD9\u672C\u4E66\u6240\u5173\u8054\u7684\u6240\u6709\u82F1\u96C4</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
book<span class="token punctuation">.</span>heroinfo_set
<span class="token comment"># \u6240\u4EE5\u5728DRF\u4E5F\u5DEE\u4E0D\u591A\u662F\u8FD9\u6837\u5199\u7684</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p>\u76EE\u7684: \u53EF\u4EE5\u5728\u5E8F\u5217\u5316\u4E66\u7C4D\u7684\u65F6\u5019, \u5C55\u793A\u5173\u8054\u7684\u82F1\u96C4\u7684\u4FE1\u606F</p></li><li><p>\u64CD\u4F5C\u6D41\u7A0B:</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,\u5B9A\u4E49\u4E66\u7C4D\u5E8F\u5217\u5316\u5668</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#1,\u5173\u8054\u82F1\u96C4\u5B57\u6BB5, \u5728\u4E00\u65B9\u4E2D,\u8F93\u51FA\u591A\u65B9\u5185\u5BB9\u7684\u65F6\u5019\u52A0\u4E0Amany=True</span>
    <span class="token comment"># heroinfo_set = serializers.PrimaryKeyRelatedField(read_only=True,many=True)</span>
    heroinfo_set <span class="token operator">=</span> serializers<span class="token punctuation">.</span>StringRelatedField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul><h4 id="\u4F7F\u7528\u5E8F\u5217\u5316\u5668\u6539\u8FDB\u4E4B\u524Ddjango\u5199\u7684\u4EE3\u7801" tabindex="-1">\u4F7F\u7528\u5E8F\u5217\u5316\u5668\u6539\u8FDB\u4E4B\u524Ddjango\u5199\u7684\u4EE3\u7801 <a class="header-anchor" href="#\u4F7F\u7528\u5E8F\u5217\u5316\u5668\u6539\u8FDB\u4E4B\u524Ddjango\u5199\u7684\u4EE3\u7801" aria-hidden="true">#</a></h4><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u83B7\u53D6\u6240\u6709\u4E66\u7C4D&#39;&#39;&#39;</span>
    <span class="token comment"># 1.\u67E5\u8BE2\u6240\u6709\u7684\u4E66\u7C4D</span>
    books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 2.\u6570\u636E\u8F6C\u6362</span>
    <span class="token comment"># book_list = []</span>
    <span class="token comment"># for book in books:</span>
    <span class="token comment">#     book_dict = {</span>
    <span class="token comment">#         &#39;id&#39;: book.id,</span>
    <span class="token comment">#         &#39;btitle&#39;: book.btitle,</span>
    <span class="token comment">#         &#39;bpub_date&#39;: book.bpub_date,</span>
    <span class="token comment">#         &#39;bread&#39;: book.bread,</span>
    <span class="token comment">#         &#39;bcomment&#39;: book.bcomment,</span>
    <span class="token comment">#     }</span>
    <span class="token comment">#     book_list.append(book_dict)</span>
    <span class="token comment"># TODO \u5E8F\u5217\u5668\u6539\u8FDB</span>
    serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


    <span class="token comment"># 3.\u8FD4\u56DE\u54CD\u5E94</span>
    <span class="token comment"># safe=False\u53EF\u4EE5\u5B89\u5168\u8FD4\u56DE\u975E\u5B57\u5178</span>
    <span class="token comment"># json_dumps_params={&#39;ensure_ascii&#39;: False}\u53EF\u4EE5\u89E3\u51B3\u8FD4\u56DE\u7684\u4E2D\u6587\u6570\u636E\u4E3A\u4E71\u7801</span>
    <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> json_dumps_params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;ensure_ascii&#39;</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div>`,14),t=[o];function l(r,c,i,u,b,k){return a(),s("div",null,t)}var _=n(p,[["render",l]]);export{d as __pageData,_ as default};
