<!DOCTYPE html>
<html lang="zh-CH">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DRF学习笔记 | Justin3go's Blog-🖊</title>
    <meta name="description" content="我的技术博客，用心记录知识碎片，汇总整理程序员知识。">
    <link rel="stylesheet" href="/assets/style.8a11ac97.css">
    <link rel="modulepreload" href="/assets/Home.fc8ba9e3.js">
    <link rel="modulepreload" href="/assets/app.0b1f5e83.js">
    <link rel="modulepreload" href="/assets/知识库_后端储备_DRF学习笔记.md.e5ebedbe.lean.js">
    
    <link rel="icon" href="/ava.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
  <meta name="twitter:title" content="DRF学习笔记 | Justin3go&#39;s Blog-🖊">
  <meta property="og:title" content="DRF学习笔记 | Justin3go&#39;s Blog-🖊">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Justin3go&#39;s Blog-🖊, back to home" data-v-675d8756 data-v-cc01ef16><!----> Justin3go&#39;s Blog-🖊</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/知识库/" data-v-b8818f8c>知识库 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/推荐/" data-v-b8818f8c>站长推荐 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://space.bilibili.com/434542518" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>B站 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/Justin3go" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/知识库/" data-v-b8818f8c>知识库 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/推荐/" data-v-b8818f8c>站长推荐 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://space.bilibili.com/434542518" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>B站 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/Justin3go" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/">算法与数据结构</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/01基础概念">基础概念</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/02线性表">线性表</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/03栈和队列">栈和队列</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/04数组">数组</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/05树">树</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/06图">图</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/07查找">查找</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/08排序">排序</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/09散列表实现查找">散列表实现查找</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/10算法概述">算法概述</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/11递归与分治">递归与分治</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/12动态规划">动态规划</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/13贪心算法">贪心算法</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/算法与数据结构/14回溯与分支极限">回溯与分支极限</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/计算机基础知识/">计算机基础知识</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/计算机基础知识/操作系统基础">操作系统基础</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/计算机基础知识/操作系统内存分配模拟程序">操作系统内存分配模拟程序</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/JavaScript/">JavaScript</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/JavaScript/这道题原来可以用到JS这么多知识点！">这道题原来可以用到JS这么多知识点！</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/JavaScript/TypeScript">TypeScript</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/CSS相关/">CSS相关</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/CSS相关/01都2022年了，还是得学圣杯布局与双飞翼布局">圣杯布局与双飞翼布局</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/">前端框架</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/01Vue3是如何运行的">Vue3是如何运行的</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/02Vue3编译器">Vue3编译器</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/03虚拟DOM">虚拟DOM</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/04Vue3-Reactivity">Vue3-Reactivity</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/05Mini-Vue">Mini-Vue</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/前端框架/06Vue3其他">Vue3其他</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/UI组件库/">UI组件库</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/数据相关/">数据相关</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/后端储备/">后端储备</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/后端储备/Django进阶学习笔记">Django进阶学习笔记</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/知识库/后端储备/DRF学习笔记">DRF学习笔记</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#restful介绍">restful介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#django基础复习">django基础复习</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#序列化器">序列化器</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#反序列化器">反序列化器</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#反序列化">反序列化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#数据入库">数据入库</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#modelserializer">ModelSerializer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#一级视图apiview">一级视图APIView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#二级视图与mixin">二级视图与Mixin</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#三级视图与视图集">三级视图与视图集</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#视图集额外动作">视图集额外动作</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#router">router</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#权限设置">权限设置</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#url可选参数设置">url可选参数设置</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#其他">其他</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/后端储备/Redis学习笔记">Redis学习笔记</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/AI相关/">AI相关</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/知识库/AI相关/TFIDF计算的学习">TFIDF计算的学习</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="drf学习笔记" tabindex="-1">DRF学习笔记 <a class="header-anchor" href="#drf学习笔记" aria-hidden="true">#</a></h1><h2 id="restful介绍" tabindex="-1">restful介绍 <a class="header-anchor" href="#restful介绍" aria-hidden="true">#</a></h2><h4 id="_1-web应用模式-了解" tabindex="-1">1,web应用模式(了解) <a class="header-anchor" href="#_1-web应用模式-了解" aria-hidden="true">#</a></h4><ul><li><p>目的: 知道web开发的两种模式</p></li><li><p>前后端分离:</p><ul><li>注意点: 业务服务器和静态服务器是分开的</li><li><img src="https://webplus-cn-shenzhen-s-6130b804f968dd14cecc43e2.oss-cn-shenzhen.aliyuncs.com/blogs/image-20191217085007969.png" alt="image-20191217085007969"></li></ul></li><li><p>前后端不分离:</p><ul><li>注意点: 页面和数据都是有后端处理的</li><li><img src="https://webplus-cn-shenzhen-s-6130b804f968dd14cecc43e2.oss-cn-shenzhen.aliyuncs.com/blogs/image-20191217085558447.png" alt="image-20191217085558447"></li></ul></li></ul><h4 id="_2-restful风格介绍-了解" tabindex="-1">2,restful风格介绍(了解) <a class="header-anchor" href="#_2-restful风格介绍-了解" aria-hidden="true">#</a></h4><ul><li>目的: 知道为什么需要使用restful风格进行开发</li><li>原因 <ul><li>每个后端开发人员可能都有自己的定义方式，风格迥异</li></ul></li><li>解决办法: <ul><li>restful</li></ul></li></ul><h4 id="_3-restful设计风格-了解" tabindex="-1">3,restful设计风格(了解) <a class="header-anchor" href="#_3-restful设计风格-了解" aria-hidden="true">#</a></h4><ul><li><p>目的: 知道常见的restful风格的标准</p></li><li><p>具体的标准:</p><ul><li><p>api部署的域名, 主域名或者专有域名</p><blockquote><p>把API部署在专有域名之下</p></blockquote><div class="language-"><pre><code>https://api.example.com //不是www开头的
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>部署在主域名之下</p></blockquote><div class="language-"><pre><code>域名/api/
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li><li><p>版本, 通过url地址或者请求头accept</p><blockquote><p>应该把版本号放在URL中</p></blockquote></li><li><p>路径, 只能有名词, 不能有动词</p><div class="language-"><pre><code>//不是&#39;/getProducts&#39;

GET /products ：将返回所有产品清单
POST /products ：将产品新建到集合
GET /products/4 ：将获取产品 4
PATCH（或）PUT /products/4 ：将更新产品 4
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p>http请求动词, get, post, update, delete</p><div class="language-"><pre><code>GET（SELECT）：从服务器取出资源（一项或多项）。
POST（CREATE）：在服务器新建一个资源。
PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。
DELETE（DELETE）：从服务器删除资源
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p>过滤信息</p><p>如果记录数量很多，服务器不可能都将它们返回给用户。API应该提供参数，过滤返回结果。</p><p>下面是一些常见的参数。</p><div class="language-"><pre><code>?limit=10：指定返回记录的数量
?offset=10：指定返回记录的开始位置。
?page=2&amp;per_page=100：指定第几页，以及每页的记录数。
?sortby=name&amp;order=asc：指定返回结果按照哪个属性排序，以及排序顺序。
?animal_type_id=1：指定筛选条件
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>参数的设计允许存在冗余，即允许API路径和URL参数偶尔有重复。比如，GET /zoos/ID/animals 与 GET /animals?zoo_id=ID 的含义是相同的。</p></blockquote></li><li><p>状态, 200, 201, 204, 400, 401, 403, 404</p><div class="language-"><pre><code>200 OK - [GET]：服务器成功返回用户请求的数据
201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。
202 Accepted - [*]：表示一个请求已经进入后台排队（异步任务）
204 NO CONTENT - [DELETE]：用户删除数据成功。
400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作
401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。
403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。
404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。
406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。
410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。
422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。
500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li><li><p>错误处理</p><p>如果状态码是4xx，服务器就应该向用户返回出错信息。一般来说，返回的信息中将error作为键名，出错信息作为键值即可。</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">{</span>
    error<span class="token operator">:</span> <span class="token string">&quot;Invalid API key&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>返回结果</p><p>针对不同操作，服务器向用户返回的结果应该符合以下规范。</p><ul><li>GET /collection：返回资源对象的列表（数组）</li><li>GET /collection/resource：返回单个资源对象</li><li>POST /collection：返回新生成的资源对象</li><li>PUT /collection/resource：返回完整的资源对象</li><li>PATCH /collection/resource：返回完整的资源对象</li><li>DELETE /collection/resource：返回一个空文档</li></ul></li><li><p>其他</p><p>返回的数据格式应该使用json，避免使用xml</p></li></ul></li></ul><h2 id="django基础复习" tabindex="-1">django基础复习 <a class="header-anchor" href="#django基础复习" aria-hidden="true">#</a></h2><h4 id="_4-restful案例-了解" tabindex="-1">4,restful案例(了解) <a class="header-anchor" href="#_4-restful案例-了解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用restful风格设计图书增删改查的案例</p></li><li><p>案例:</p><table><thead><tr><th>功能</th><th>路径</th><th>请求方式</th><th>响应状态码</th></tr></thead><tbody><tr><td>获取所有的书籍</td><td>/books</td><td>get</td><td>200</td></tr><tr><td>创建书籍</td><td>/books</td><td>post</td><td>201</td></tr><tr><td>获取单个书籍</td><td id="">/books/</td><td>get</td><td>200</td></tr><tr><td>修改书籍</td><td id="">/books/</td><td>put</td><td>201</td></tr><tr><td>删除书籍</td><td id="">/books/</td><td>delete</td><td>204</td></tr></tbody></table></li></ul><h4 id="_5-数据准备" tabindex="-1">5,数据准备 <a class="header-anchor" href="#_5-数据准备" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以将图书和英雄的信息添加到数据中</p></li><li><p>操作流程:</p><ul><li><p>1, 创建项目, 创建book子应用</p></li><li><p>2, 在子应用中定义模型类</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models

<span class="token comment"># 定义图书模型类BookInfo</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    btitle <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;名称&#39;</span><span class="token punctuation">)</span>
    bpub_date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&#39;发布日期&#39;</span><span class="token punctuation">)</span>
    bread <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;阅读量&#39;</span><span class="token punctuation">)</span>
    bcomment <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;评论量&#39;</span><span class="token punctuation">)</span>
    is_delete <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;逻辑删除&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">&#39;tb_books&#39;</span>  <span class="token comment"># 指明数据库表名</span>
        verbose_name <span class="token operator">=</span> <span class="token string">&#39;图书&#39;</span>  <span class="token comment"># 在admin站点中显示的名称</span>
        verbose_name_plural <span class="token operator">=</span> verbose_name  <span class="token comment"># 显示的复数名称</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;定义每个数据对象的显示信息&quot;&quot;&quot;</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>btitle

<span class="token comment"># 定义英雄模型类HeroInfo</span>
<span class="token keyword">class</span> <span class="token class-name">HeroInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    GENDER_CHOICES <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;male&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;female&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    hname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;名称&#39;</span><span class="token punctuation">)</span>
    hgender <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>GENDER_CHOICES<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;性别&#39;</span><span class="token punctuation">)</span>
    hcomment <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;描述信息&#39;</span><span class="token punctuation">)</span>
    hbook <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>BookInfo<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;图书&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 外键</span>
    is_delete <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;逻辑删除&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">&#39;tb_heros&#39;</span>
        verbose_name <span class="token operator">=</span> <span class="token string">&#39;英雄&#39;</span>
        verbose_name_plural <span class="token operator">=</span> verbose_name

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>hname
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div></li><li><p>3, 注册子应用, 设置数据库配置</p></li><li><p>4, 创建数据库, 迁移</p></li></ul></li></ul><h4 id="_6-查询所有数据-理解" tabindex="-1">6,查询所有数据(理解) <a class="header-anchor" href="#_6-查询所有数据-理解" aria-hidden="true">#</a></h4><blockquote><p>查询和创建都属于列表视图，而代带参数的请求属于详情视图</p></blockquote><ul><li><p>目的: 可以编写视图查询所有的书籍信息</p></li><li><p>注意点:</p><ul><li>http.JsonResponse(books_list,safe=<strong>False</strong>) <ul><li>safe=False允许非字典数据可以被返回</li></ul></li></ul></li><li><p>代码</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># /book/views.py</span>
<span class="token comment"># 列表视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoView</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&#39;&#39;&#39;获取所有书籍&#39;&#39;&#39;</span>
        <span class="token comment"># 1.查询所有的书籍</span>
        books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 2.数据转换</span>
        book_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> book <span class="token keyword">in</span> books<span class="token punctuation">:</span>
            book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
                <span class="token string">&#39;btitle&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>btitle<span class="token punctuation">,</span>
                <span class="token string">&#39;bpub_date&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bpub_date<span class="token punctuation">,</span>
                <span class="token string">&#39;bread&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bread<span class="token punctuation">,</span>
                <span class="token string">&#39;bcomment&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bcomment<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            book_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>

        <span class="token comment"># 3.返回响应</span>
        <span class="token comment"># safe=False可以安全返回非字典</span>
        <span class="token comment"># json_dumps_params={&#39;ensure_ascii&#39;: False}可以解决返回的中文数据为乱码</span>
        <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>book_list<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> json_dumps_params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;ensure_ascii&#39;</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    
other<span class="token punctuation">:</span>
<span class="token comment"># /book/urls</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span><span class="token string">&#39;books/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>BookInfoView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
<span class="token comment"># /project/urls</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&#39;admin/&#39;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">&#39;book.urls&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div></li></ul><h4 id="_7-创建对象-理解" tabindex="-1">7,创建对象(理解) <a class="header-anchor" href="#_7-创建对象-理解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以添加书籍对象到数据库中</p></li><li><p>注意点:</p><ul><li>book = BookInfo.objects.create(**data_dict)</li></ul></li><li><p>完整代码</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># 请求的时候只需要修改清请求方式就可以了，请求路径是不变的</span>
<span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;创建单本书籍&#39;&#39;&#39;</span>
    <span class="token comment"># 1.获取参数,把json转换为字典</span>
    dict_data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    btitle <span class="token operator">=</span> dict_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;btitle&#39;</span><span class="token punctuation">)</span>
    bpub_date <span class="token operator">=</span> dict_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;bpub_date&#39;</span><span class="token punctuation">)</span>
    bread <span class="token operator">=</span> dict_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;bread&#39;</span><span class="token punctuation">)</span>
    bcomment <span class="token operator">=</span> dict_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;bcomment&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.校验参数(省略)</span>

    <span class="token comment"># 3.数据入库</span>
    book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>dict_data<span class="token punctuation">)</span>
    <span class="token comment"># 4.返回响应</span>
    book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
        <span class="token string">&#39;btitle&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>btitle<span class="token punctuation">,</span>
        <span class="token string">&#39;bpub_date&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bpub_date<span class="token punctuation">,</span>
        <span class="token string">&#39;bread&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bread<span class="token punctuation">,</span>
        <span class="token string">&#39;bcomment&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bcomment<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul><h4 id="_8-获取单个对象-理解" tabindex="-1">8,获取单个对象(理解) <a class="header-anchor" href="#_8-获取单个对象-理解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以获取指定书籍对象</p></li><li><p>注意点:</p><ul><li>book = BookInfo.objects.get(id=book_id)</li></ul></li><li><p>完整代码</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># 详情视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoDetailView</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.通过pk获取对象</span>
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
        <span class="token comment"># 2.转换数据</span>
        book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            <span class="token string">&#39;btitle&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>btitle<span class="token punctuation">,</span>
            <span class="token string">&#39;bpub_date&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bpub_date<span class="token punctuation">,</span>
            <span class="token string">&#39;bread&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bread<span class="token punctuation">,</span>
            <span class="token string">&#39;bcomment&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bcomment<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># 3.返回响应</span>
        <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">)</span>
    
<span class="token comment"># 注意这里的url——path</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span><span class="token string">&#39;^books/$&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>BookInfoView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">&#39;^books/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>BookInfoDetailView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
<span class="token comment"># 其中^代表起始符，$代表结束符</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul><h4 id="_9-修改单个对象-理解" tabindex="-1">9,修改单个对象(理解) <a class="header-anchor" href="#_9-修改单个对象-理解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以修改指定书籍对象</p></li><li><p>注意点:</p><ul><li>BookInfo.objects.filter(id=book_id).update(**data_dict)</li></ul></li><li><p>完整代码</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 1.获取参数</span>
    dict_data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
    <span class="token comment"># 2.校验参数</span>

    <span class="token comment"># 3.数据入库</span>
    BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">**</span>dict_data<span class="token punctuation">)</span>
    <span class="token comment"># 把更新之后的数据拿出来返回</span>
    book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
    book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
        <span class="token string">&#39;btitle&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>btitle<span class="token punctuation">,</span>
        <span class="token string">&#39;bpub_date&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bpub_date<span class="token punctuation">,</span>
        <span class="token string">&#39;bread&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bread<span class="token punctuation">,</span>
        <span class="token string">&#39;bcomment&#39;</span><span class="token punctuation">:</span> book<span class="token punctuation">.</span>bcomment<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># 4.返回响应</span>
    <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>book_dict<span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul><h4 id="_10-删除单个对象-理解" tabindex="-1">10,删除单个对象(理解) <a class="header-anchor" href="#_10-删除单个对象-理解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以删除指定书籍对象</p></li><li><p>注意点:</p><ul><li>BookInfo.objects.get(id=book_id).delete()</li></ul></li><li><p>代码</p></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 1.获取数据</span>
    book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>pk<span class="token punctuation">)</span>
    <span class="token comment"># 2.删除数据</span>
    book<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 3.返回响应</span>
    <span class="token keyword">return</span> http<span class="token punctuation">.</span>HttpResponse<span class="token punctuation">(</span>status<span class="token operator">=</span><span class="token number">204</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul><h2 id="序列化器" tabindex="-1">序列化器 <a class="header-anchor" href="#序列化器" aria-hidden="true">#</a></h2><h4 id="_12-序列化器概述-了解" tabindex="-1">12,序列化器概述(了解) <a class="header-anchor" href="#_12-序列化器概述-了解" aria-hidden="true">#</a></h4><ul><li>目的: 知道序列化器的作用</li><li>序列化器的作用: <ul><li>1, 反序列化: 把json(dict), 转成模型类对象 (校验,入库)</li><li>2, 序列化: 将模型类对象, 转成json(dict)数据</li></ul></li></ul><h4 id="_13-序列化器定义-掌握" tabindex="-1">13,序列化器定义(掌握) <a class="header-anchor" href="#_13-序列化器定义-掌握" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以定义书籍的序列化器</p></li><li><p>操作流程:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token triple-quoted-string string">&quot;&quot;&quot;
定义序列化器:
1, 定义类, 继承自Serializer
2, 编写字段名称, 和模型类一样
3, 编写字段类型, 和模型类一样
4, 编写字段选项, 和模型类一样
    read_only: 只读
    label: 字段说明

序列化器作用:
1, 反序列化: 将json(dict)数据, 转成模型类对象
    ①: 校验
    ②: 入库
    
2, 序列化: 将模型类对象, 转成json(dict)数据
&quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token comment">#1,定义书籍序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;书籍编号&quot;</span><span class="token punctuation">)</span>
    btitle <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;名称&quot;</span><span class="token punctuation">)</span>
    bpub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&quot;发布日期&quot;</span><span class="token punctuation">)</span>
    bread <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;阅读量&quot;</span><span class="token punctuation">)</span>
    bcomment <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;评论量&quot;</span><span class="token punctuation">)</span>
    is_delete <span class="token operator">=</span> serializers<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;逻辑删除&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></li></ul><h4 id="_14-序列化器-序列化单个对象-掌握" tabindex="-1">14,序列化器,序列化单个对象(掌握) <a class="header-anchor" href="#_14-序列化器-序列化单个对象-掌握" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以将单本数据使用序列化器, 转成json(dict)数据</p></li><li><p>操作流程:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,获取书籍对象</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">#2,创建序列化器对象, instance=book 表示将哪一本数据进行序列化</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>

<span class="token comment">#3,输出序列化之后的结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
{&#39;id&#39;: 1, &#39;btitle&#39;: &#39;射雕英雄传&#39;, &#39;bpub_date&#39;: &#39;1980-05-01&#39;, &#39;bread&#39;: 12, &#39;bcomment&#39;: 34, &#39;is_delete&#39;: False}
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul><h4 id="_15-序列化器-序列化列表数据-掌握" tabindex="-1">15,序列化器,序列化列表数据(掌握) <a class="header-anchor" href="#_15-序列化器-序列化列表数据-掌握" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用序列化器,对列表中的多个对象进行序列化</p></li><li><p>操作流程:</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,查询所有的书籍</span>
books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#2,创建序列化器对象,many=True 表示传入的是列表对象(多个数据)</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#3,输出序列化的结果</span>
serializer<span class="token punctuation">.</span>data
<span class="token triple-quoted-string string">&quot;&quot;&quot;
[
OrderedDict([(&#39;id&#39;, 1), (&#39;btitle&#39;, &#39;射雕英雄传&#39;), (&#39;bpub_date&#39;, &#39;1980-05-01&#39;), (&#39;bread&#39;, 12), (&#39;bcomment&#39;, 34), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39; (&#39;btitle&#39;, &#39;天龙八部&#39;), (&#39;bpub_date&#39;, &#39;1986-07-24&#39;), (&#39;bread&#39;, 36), (&#39;bcomment&#39;, 40), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 3), (&#39;btitle&#39;, &#39;笑傲江湖&#39;), (&#39;bp, &#39;1995-12-24&#39;), (&#39;bread&#39;, 20), (&#39;bcomment&#39;, 80), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 4), (&#39;btitle&#39;, &#39;雪山飞狐&#39;), (&#39;bpub_date&#39;, &#39;1987-11-11&#39;), (&#39;bread&#39;, 58&#39;bcomment&#39;, 24), (&#39;is_delete&#39;, False)]), 
OrderedDict([(&#39;id&#39;, 6), (&#39;btitle&#39;, &#39;金瓶x2&#39;), (&#39;bpub_date&#39;, &#39;2019-01-01&#39;), (&#39;bread&#39;, 10), (&#39;bcomment&#39;, 5), (&#39;is_delete&#39;, Fse)])
]
&quot;&quot;&quot;</span>
<span class="token comment"># OrderedDict: 有序字典</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>注意点:</p><ul><li>serializer = BookSerializer(instance=books,many=True)</li><li>instance: 需要序列化的对象</li><li>many=True: 默认是None, 如果传入True, 需要序列化的对象是列表</li><li>serializer.data: 表示输出序列化之后的结果</li></ul></li></ul><h4 id="_16-英雄序列化器关联外键-掌握" tabindex="-1">16,英雄序列化器关联外键(掌握) <a class="header-anchor" href="#_16-英雄序列化器关联外键-掌握" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以将关联英雄的书籍信息, 三种形式表示出来</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#2,定义英雄序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">HeroInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;英雄数据序列化器&quot;&quot;&quot;</span>
    GENDER_CHOICES <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;male&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;female&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    hname <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;名字&#39;</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    hgender <span class="token operator">=</span> serializers<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span>choices<span class="token operator">=</span>GENDER_CHOICES<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;性别&#39;</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    hcomment <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&#39;描述信息&#39;</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> allow_null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment">#1,添加外键,主键表示 必须提供`queryset` 选项, 或者设置 read_only=`True`.</span>
    <span class="token comment"># queryset=BookInfo.objects.all()表示把所有书籍全部查出来让他自己去匹配。</span>
    
    <span class="token comment"># hbook = serializers.PrimaryKeyRelatedField(queryset=BookInfo.objects.all())</span>
    <span class="token comment"># hbook = serializers.PrimaryKeyRelatedField(read_only=True)</span>

    <span class="token comment">#2,添加外键, 来自于关联模型类, __str__的返回值</span>
    <span class="token comment"># hbook = serializers.StringRelatedField(read_only=True)</span>

    <span class="token comment">#3,添加外键,关联另外一个序列化器，返回整本书的全部信息（书已经定义好序列化器）</span>
    hbook <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li><li><p>2, 类视图</p><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot; ===============3, 英雄序列化器, 关联外键 ================= &quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> HeroInfo
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> HeroInfoSerializer

<span class="token comment">#1,获取单个英雄</span>
hero <span class="token operator">=</span> HeroInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">#2,创建英雄序列化器</span>
serializer <span class="token operator">=</span> HeroInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>hero<span class="token punctuation">)</span>

<span class="token comment">#3,输出结果</span>
serializer<span class="token punctuation">.</span>data

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li></ul><h4 id="_17-书籍序列化器-关联many-掌握" tabindex="-1">17,书籍序列化器,关联many(掌握) <a class="header-anchor" href="#_17-书籍序列化器-关联many-掌握" aria-hidden="true">#</a></h4><ul><li><p>django小复习:</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># 知道一个英雄，如何查出这个英雄所在的书籍</span>
hero <span class="token operator">=</span> HeroInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
hero<span class="token punctuation">.</span>hbook
<span class="token comment"># 反过来，知道一本书，如何查出这本书所关联的所有英雄</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
book<span class="token punctuation">.</span>heroinfo_set
<span class="token comment"># 所以在DRF也差不多是这样写的</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p>目的: 可以在序列化书籍的时候, 展示关联的英雄的信息</p></li><li><p>操作流程:</p><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,定义书籍序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#1,关联英雄字段, 在一方中,输出多方内容的时候加上many=True</span>
    <span class="token comment"># heroinfo_set = serializers.PrimaryKeyRelatedField(read_only=True,many=True)</span>
    heroinfo_set <span class="token operator">=</span> serializers<span class="token punctuation">.</span>StringRelatedField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul><h4 id="使用序列化器改进之前django写的代码" tabindex="-1">使用序列化器改进之前django写的代码 <a class="header-anchor" href="#使用序列化器改进之前django写的代码" aria-hidden="true">#</a></h4><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;获取所有书籍&#39;&#39;&#39;</span>
    <span class="token comment"># 1.查询所有的书籍</span>
    books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 2.数据转换</span>
    <span class="token comment"># book_list = []</span>
    <span class="token comment"># for book in books:</span>
    <span class="token comment">#     book_dict = {</span>
    <span class="token comment">#         &#39;id&#39;: book.id,</span>
    <span class="token comment">#         &#39;btitle&#39;: book.btitle,</span>
    <span class="token comment">#         &#39;bpub_date&#39;: book.bpub_date,</span>
    <span class="token comment">#         &#39;bread&#39;: book.bread,</span>
    <span class="token comment">#         &#39;bcomment&#39;: book.bcomment,</span>
    <span class="token comment">#     }</span>
    <span class="token comment">#     book_list.append(book_dict)</span>
    <span class="token comment"># TODO 序列器改进</span>
    serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


    <span class="token comment"># 3.返回响应</span>
    <span class="token comment"># safe=False可以安全返回非字典</span>
    <span class="token comment"># json_dumps_params={&#39;ensure_ascii&#39;: False}可以解决返回的中文数据为乱码</span>
    <span class="token keyword">return</span> http<span class="token punctuation">.</span>JsonResponse<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> json_dumps_params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;ensure_ascii&#39;</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="反序列化器" tabindex="-1">反序列化器 <a class="header-anchor" href="#反序列化器" aria-hidden="true">#</a></h2><h3 id="反序列化" tabindex="-1">反序列化 <a class="header-anchor" href="#反序列化" aria-hidden="true">#</a></h3><blockquote><p>校验：</p><ol><li>字段类型校验</li><li>字段选项校验</li><li>单字段，校验（方法）</li><li>多字段校验（方法）</li><li>自定义校验（方法）</li></ol></blockquote><h4 id="_18-反序列化-字段类型校验" tabindex="-1">18,反序列化-字段类型校验 <a class="header-anchor" href="#_18-反序列化-字段类型校验" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用序列化器,对数据进行校验操作</p></li><li><p>操作流程: serializer.is_valid(raise_exception=True)</p><div class="language-Python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶x-插画版&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">25</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验, raise_exception=True, 校验不通过,抛出异常信息</span>
<span class="token comment"># 也可以直接打印错误信息print(serializer.error_messages)</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul><h4 id="_19-反序列化-字段选项校验" tabindex="-1">19,反序列化-字段选项校验 <a class="header-anchor" href="#_19-反序列化-字段选项校验" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用序列化器,对数据进行选项约束校验</p></li><li><p>操作流程: serializer.is_valid(raise_exception=True)</p><ul><li><p>1, 序列化器</p><ul><li><p>min_value=0</p></li><li><p>max_value=50</p></li><li><p>required: 默认就是True，必须要传递，除非设置了default | false | read_only</p></li><li><p>有read_only=True，会进行序列化操作，并且反序列化时不需要传该参也能校验通过（不进行反序列化）</p></li><li><p>约束演示</p></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    bread <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>min_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;阅读量&quot;</span><span class="token punctuation">)</span>
    bcomment <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>max_value<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;评论量&quot;</span><span class="token punctuation">)</span>
    is_delete <span class="token operator">=</span> serializers<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;逻辑删除&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶x&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">99</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_20-反序列化-单字段校验" tabindex="-1">20,反序列化-单字段校验 <a class="header-anchor" href="#_20-反序列化-单字段校验" aria-hidden="true">#</a></h4><blockquote><p>在调用is_vaild方法的时候，它会进入你编写的单字段检验方法</p><p>其中vaildata()代表多字段校验，而后面跟上下划线加上字段名为方法名的话代表该方法为单字段校验</p><p>attrs就是传过来的数据：在这里是btitle</p></blockquote><ul><li><p>目的: 可以编写单字段校验方法, 对btitle进行校验</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#3, 单字段校验, 方法; 需求: 添加的书籍必须包含&#39;金瓶&#39;</span>
    <span class="token keyword">def</span> <span class="token function">validate_btitle</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value = {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">#1,判断传入的value中是否包含金瓶</span>
        <span class="token keyword">if</span> <span class="token string">&quot;金瓶&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> attrs<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">&quot;书名必须包含金瓶&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">#2,返回结果</span>
        <span class="token keyword">return</span> attrs
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶x&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul></li></ul></li><li><p>注意点:</p><ul><li>单字段校验方法 <ul><li>def validate_==字段名==(self,value): <ul><li>pass</li></ul></li></ul></li><li>如果校验不通过,直接抛出异常即可</li></ul></li></ul><h4 id="_21-反序列化-多字段校验" tabindex="-1">21,反序列化-多字段校验 <a class="header-anchor" href="#_21-反序列化-多字段校验" aria-hidden="true">#</a></h4><blockquote><p>这里接收的attrs就是传入的整个字典了</p></blockquote><ul><li><p>目的: 可以编写多字段校验方法, 对阅读量和评论量进行判断（两两之间比较常用多字段校验）</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#4,多字段校验, 方法; 添加书籍的时候,评论量不能大于阅读量</span>
    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        :param attrs: 外界传入的需要校验的字典
        :return:
        &quot;&quot;&quot;</span>
        <span class="token comment">#1,判断评论量和阅读量的关系</span>
        <span class="token keyword">if</span> attrs<span class="token punctuation">[</span><span class="token string">&quot;bread&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> attrs<span class="token punctuation">[</span><span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">&quot;评论量不能大于阅读量&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">#2,返回结果</span>
        <span class="token keyword">return</span> attrs
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot; ===============7, 反序列化-多字段校验 ================= &quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶xxx&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">22</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_22-反序列化-自定义校验-理解" tabindex="-1">22,反序列化-自定义校验(理解) <a class="header-anchor" href="#_22-反序列化-自定义校验-理解" aria-hidden="true">#</a></h4><blockquote><p>把自定义的校验方法名加入到字段的选项validators中</p></blockquote><ul><li><p>目的: 可以自定义方法,对日期进行校验</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#需求: 添加的书籍的日期不能小于2015年</span>
<span class="token keyword">def</span> <span class="token function">check_bpub_date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;date = {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> date<span class="token punctuation">.</span>year <span class="token operator">&lt;</span> <span class="token number">2015</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">&quot;日期不能小于2015年&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> date
  
<span class="token comment">#1,定义书籍序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    bpub_date <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&quot;发布日期&quot;</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span>check_bpub_date<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot; ===============8, 反序列化-自定义校验 ================= &quot;&quot;&quot;</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶xxx&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2011-11-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul></li></ul></li></ul><h3 id="数据入库" tabindex="-1">数据入库 <a class="header-anchor" href="#数据入库" aria-hidden="true">#</a></h3><ol><li>创建新的对象</li><li>更新 对象</li></ol><h4 id="_23-反序列化-数据入库create-掌握" tabindex="-1">23,反序列化-数据入库create(掌握) <a class="header-anchor" href="#_23-反序列化-数据入库create-掌握" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以将书籍对象保存到数据库中</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    
  <span class="token comment">#5,重写create方法,实现数据入库</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># print(&quot;validated_data = {}&quot;.format(validated_data))</span>

        <span class="token comment">#1,创建book对象,入库</span>
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>

        <span class="token comment">#2,返回响应</span>
        <span class="token keyword">return</span> book
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶xxx-精装版&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2015-11-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#4,入库</span>
serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li><li><p>注意点:</p></li><li><p><img src="https://webplus-cn-shenzhen-s-6130b804f968dd14cecc43e2.oss-cn-shenzhen.aliyuncs.com/blogs/image-20191217154212337-16347388278283.png" alt="image-20191217154212337"></p></li></ul></li></ul><h4 id="_24-反序列化-数据更新update-掌握" tabindex="-1">24,反序列化-数据更新update(掌握) <a class="header-anchor" href="#_24-反序列化-数据更新update-掌握" aria-hidden="true">#</a></h4><blockquote><p>当创建序列化器的时候传递了两个参数，它会自动去找update()方法</p></blockquote><ul><li><p>目的: 可以重写update方法, 更新数据库中指定的书籍</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   
  <span class="token comment">#6,重写update方法,实现数据更新</span>
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        :param instance: 需要更新的对象
        :param validated_data: 验证成功之后的数据
        :return:
        &quot;&quot;&quot;</span>
        <span class="token comment">#1,更新数据</span>
        instance<span class="token punctuation">.</span>btitle <span class="token operator">=</span> validated_data<span class="token punctuation">[</span><span class="token string">&quot;btitle&quot;</span><span class="token punctuation">]</span>
        instance<span class="token punctuation">.</span>bpub_date <span class="token operator">=</span> validated_data<span class="token punctuation">[</span><span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">]</span>
        instance<span class="token punctuation">.</span>bread <span class="token operator">=</span> validated_data<span class="token punctuation">[</span><span class="token string">&quot;bread&quot;</span><span class="token punctuation">]</span>
        instance<span class="token punctuation">.</span>bcomment <span class="token operator">=</span> validated_data<span class="token punctuation">[</span><span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">]</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#2,返回数据</span>
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>instance<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> book
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoSerializer
<span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo

<span class="token comment">#1,准备字典数据</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金瓶xxx-连环画&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2019-11-11&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">20</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">,</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验</span>
<span class="token comment"># serializer.is_valid()</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#4,入库</span>
serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li></ul></li><li><p>注意点:</p><ul><li><img src="https://webplus-cn-shenzhen-s-6130b804f968dd14cecc43e2.oss-cn-shenzhen.aliyuncs.com/blogs/image-20191217160603632-16347388187162.png" alt="image-20191217160603632"></li></ul></li></ul></li></ul><h2 id="modelserializer" tabindex="-1">ModelSerializer <a class="header-anchor" href="#modelserializer" aria-hidden="true">#</a></h2><h4 id="_1-modelserializer" tabindex="-1">1,ModelSerializer <a class="header-anchor" href="#_1-modelserializer" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用ModelSerializer根据模型类生成字段</p></li><li><p><strong>作用:</strong></p><ul><li>1, 可以参考模型类自动生成字段, 还可以自己编写字段</li><li>2, 提供了create方法,update方法</li></ul></li><li><p>操作流程:</p><ul><li><p>1, 定义模型类序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> book<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo

<span class="token comment">#1,定义书籍模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># mobile = serializers.CharField(max_length=11,min_length=11,label=&quot;手机号&quot;,write_only=True)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> BookInfo <span class="token comment">#参考模型类生成字段</span>
        fields <span class="token operator">=</span> <span class="token string">&quot;__all__&quot;</span> <span class="token comment">#生成所有字段</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul></li><li><p>2, 测试结果</p><p>1, 使用模型类序列化器, 测试序列化</p><blockquote><p>人为在序列器添加字段，而模型类里面不添加主要是有些数据需要校验，但不需要入库，比如短信验证码；</p><p>直接输出可能会报错，因为序列化器里面有人为添加的mobile字段，而模型类里面没有，解决方案有1里面的下面几种：</p></blockquote><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
1, 模型类中添加mobile字段
2, 删除序列化器中的mobile
3, 动态添加一mobile属性
4, 将mobile字段设置为write_only(只写,只进行反序列化)
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookModelSerializer

<span class="token comment">#1,获取模型类对象</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># book.mobile = &quot;13838389438&quot;</span>

<span class="token comment">#2,创建序列化器对象</span>
serializer <span class="token operator">=</span> BookModelSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>

<span class="token comment">#3,输出结果</span>
serializer<span class="token punctuation">.</span>data
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>2, 使用模型类序列化器, 测试反序列化, 入库操作</p><blockquote><p>自动带有create()方法</p></blockquote><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> book<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token comment">#1,准备字典数据</span>
book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;鹿鼎记1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1999-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,序列化器对象创建</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>book_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验,入库</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>3, 使用模型类序列化器, 测试反序列化, 更新操作</p><blockquote><p>自动带有update()方法</p></blockquote><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> booktest<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookModelSerializer
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo

<span class="token comment">#1,准备字典数据, 书籍对象</span>
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>
book_dict <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;btitle&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;鹿鼎记2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1999-01-01&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>

<span class="token comment">#2,序列化器对象创建</span>
serializer <span class="token operator">=</span> BookModelSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">,</span>data<span class="token operator">=</span>book_dict<span class="token punctuation">)</span>

<span class="token comment">#3,校验,入库</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul></li></ul><h4 id="_2-fields" tabindex="-1">2, fields <a class="header-anchor" href="#_2-fields" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用fields生成指定的字段</p></li><li><p>操作流程:</p><ul><li><p>1, 序列化器</p></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,定义书籍模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    mobile <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span>min_length<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">&quot;手机号&quot;</span><span class="token punctuation">,</span>write_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> BookInfo <span class="token comment">#参考模型类生成字段</span>
        <span class="token comment"># fields = &quot;__all__&quot; #生成所有字段</span>

        <span class="token comment">#1,生成指定的字段</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;btitle&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;mobile&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li><li><p>fields: 生成指定的字段</p></li><li><p>注意点:</p><ul><li>进入到ModelSerializer父类, 1063行源码中存在</li></ul></li></ul></li></ul><h4 id="_3-read-only-fields" tabindex="-1">3,read_only_fields <a class="header-anchor" href="#_3-read-only-fields" aria-hidden="true">#</a></h4><ul><li><p>目的:可以使用read_only_fields设置只读字段</p></li><li><p>操作流程:</p><ul><li><p>1,序列化器</p></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,定义书籍模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        
        <span class="token comment">#2,设置只读字段</span>
        read_only_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;btitle&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bpub_date&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li></ul><h4 id="_4-extra-kwargs" tabindex="-1">4,extra_kwargs <a class="header-anchor" href="#_4-extra-kwargs" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用extra_kwargs, 给生成的字段,添加选项约束，就是它自动生成的约束满足不了实际需求</p></li><li><p>操作流程:</p><blockquote><p>对应的字段名加上选项名的字典就可以了</p></blockquote><ul><li><p>1, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,定义书籍模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">#3,给生成的字段添加额外约束</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;bread&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
                <span class="token string">&quot;max_value&quot;</span><span class="token punctuation">:</span><span class="token number">999999</span><span class="token punctuation">,</span>
                <span class="token string">&quot;min_value&quot;</span><span class="token punctuation">:</span><span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">&quot;bcomment&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;max_value&quot;</span><span class="token punctuation">:</span> <span class="token number">888888</span><span class="token punctuation">,</span>
                <span class="token string">&quot;min_value&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul></li></ul></li></ul><h2 id="一级视图apiview" tabindex="-1">一级视图APIView <a class="header-anchor" href="#一级视图apiview" aria-hidden="true">#</a></h2><h4 id="_5-apiview之request" tabindex="-1">5,APIView之request <a class="header-anchor" href="#_5-apiview之request" aria-hidden="true">#</a></h4><ul><li><p>目的: 知道APIView的特点, 并且可以通过request获取参数</p></li><li><p><strong>特点:</strong></p><ul><li><p>1, 继承自View</p></li><li><p>2, 提供了自己的request对象</p><ul><li>get参数: request.query_params</li><li>post参数: request.data</li></ul></li><li><p>3, 提供了自己的response对象</p></li><li><p>4, 并且提供了认证, 权限, 限流等功能</p><blockquote><p>获取数据的方式不一样了</p></blockquote></li></ul></li><li><p>操作流程:</p><ul><li><p>1, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,定义类,集成APIView</span>
<span class="token keyword">class</span> <span class="token class-name">BookAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        View获取数据方式:
            GET:
                request.GET
            POST:
                request.POST
                request.body

        APIView获取数据方式
            GET:
                reqeust.query_params
            POST:
                request.data

        :param request:
        :return:
        &quot;&quot;&quot;</span>
        <span class="token comment">#1,获取APIVIew中的get请求参数</span>
        <span class="token comment"># print(request.query_params)</span>

        <span class="token keyword">return</span> http<span class="token punctuation">.</span>HttpResponse<span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># 2,获取APIView中的post的参数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

        <span class="token keyword">return</span> http<span class="token punctuation">.</span>HttpResponse<span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_6-apiview之response" tabindex="-1">6,APIView之Response <a class="header-anchor" href="#_6-apiview之response" aria-hidden="true">#</a></h4><ul><li><p>目的: <strong>可以使用response响应各种数据和状态</strong></p></li><li><p>好处:</p><ul><li>1,使用一个类, 就可以替代以前View中的各种类型的Response(HttpResponse,JsonResponse….)</li><li>2, 可以配合状态码status使用</li></ul></li><li><p>操作流程:</p><ul><li><p>1,类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> django <span class="token keyword">import</span> http
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status

<span class="token comment">#1,定义类,集成APIView</span>
<span class="token keyword">class</span> <span class="token class-name">BookAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

			<span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>	<span class="token punctuation">{</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_7-apiview实现列表视图" tabindex="-1">7,APIView实现列表视图 <a class="header-anchor" href="#_7-apiview实现列表视图" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用序列化器和APIView对列表视图进行<strong>改写</strong></p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># url(r&#39;^books/$&#39;,views.BookAPIView.as_view()),</span>
    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookListAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#2,序列化器和APIView实现列表视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookListAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,查询所有的书籍</span>
        books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#2,将对象列表转成字典列表</span>
        serializr <span class="token operator">=</span> BookInfoModelSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token comment">#3,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializr<span class="token punctuation">.</span>data<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,获取参数</span>
        data_dict <span class="token operator">=</span> request<span class="token punctuation">.</span>data

        <span class="token comment">#2,创建序列化器</span>
        serializer <span class="token operator">=</span> BookInfoModelSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

        <span class="token comment">#3,校验,入库</span>
        serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_201_CREATED<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></li></ul></li><li><p>3, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo

<span class="token comment">#1,定义书籍模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> BookInfo
        fields <span class="token operator">=</span> <span class="token string">&quot;__all__&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_8-apiview实现详情视图" tabindex="-1">8,APIView实现详情视图 <a class="header-anchor" href="#_8-apiview实现详情视图" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用模型类序列化器和APVIew改写详情视图</p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  
    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/(?P&lt;book_id&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookDetailAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># 3,序列化器和APIView实现详情视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookDetailAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># 1,获取书籍</span>
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>book_id<span class="token punctuation">)</span>

        <span class="token comment"># 2,创建序列化器对象</span>
        serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>

        <span class="token comment"># 4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span> status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># 1,获取数据,获取对象</span>
        data_dict <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>book_id<span class="token punctuation">)</span>

        <span class="token comment"># 2,创建序列化器对象</span>
        serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">,</span> data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

        <span class="token comment"># 3,校验,入库</span>
        serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span> status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_201_CREATED<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># 1,删除书籍</span>
        BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>book_id<span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 2,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_204_NO_CONTENT<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div></li></ul></li></ul></li></ul><h2 id="二级视图与mixin" tabindex="-1">二级视图与Mixin <a class="header-anchor" href="#二级视图与mixin" aria-hidden="true">#</a></h2><h4 id="_9-二级视图-实现列表视图" tabindex="-1">9,二级视图,实现列表视图 <a class="header-anchor" href="#_9-二级视图-实现列表视图" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以通过GenericAPIView改写列表视图</p><blockquote><p>主要就是把各个方法调用的模型类放到类的属性上，这样比如换成英雄的时候只需要改改类属性就可以了，而不是到每个方法里面单独修改，相对于之前的，代码还没有减少但复用性更好；</p></blockquote></li><li><p>操作流程:</p><ul><li><p>1,子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>url<span class="token punctuation">(</span><span class="token string">r&#39;^generic_apiview_books/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookListGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#4,二级视图GenericAPIView特点</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
特点: 
1, GenericAPIView,继承自APIView类，为列表视图, 和详情视图,添加了常用的行为和属性。
    行为(方法)
        get_queryset
        get_serializer
    
    属性
        queryset
        serializer_class

2, 可以和一个或多个mixin类配合使用。
&quot;&quot;&quot;</span>

<span class="token comment">#5,使用二级视图GenericAPIView实现, 列表视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookListGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供公共的属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer


    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,查询所有的书籍</span>
        <span class="token comment"># books = self.queryset</span>
        books <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#2,将对象列表转成字典列表</span>
        <span class="token comment"># serializr = BookInfoModelSerializer(instance=books,many=True)</span>
        <span class="token comment"># serializr = self.serializer_class(instance=books,many=True)</span>
        <span class="token comment"># serializr = self.get_serializer_class()(instance=books,many=True)</span>
        serializr <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token comment">#3,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializr<span class="token punctuation">.</span>data<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,获取参数</span>
        data_dict <span class="token operator">=</span> request<span class="token punctuation">.</span>data

        <span class="token comment">#2,创建序列化器</span>
        <span class="token comment"># serializer = BookInfoModelSerializer(data=data_dict)</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

        <span class="token comment">#3,校验,入库</span>
        serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_201_CREATED<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_10-二级视图-实现详情视图" tabindex="-1">10,二级视图,实现详情视图 <a class="header-anchor" href="#_10-二级视图-实现详情视图" aria-hidden="true">#</a></h4><blockquote><p>这里用到了get_object()方法，下面会讲；需要注意的是，因为源码已经写死了，所以这里需要固定把传进来的参数写成pk；</p></blockquote><ul><li><p>目的: 可以使用GenericAPIView改写详情视图</p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>url<span class="token punctuation">(</span><span class="token string">r&#39;^generic_apiview_books/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookDetailGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#6,使用二级视图GenericAPIView实现, 详情视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookDetailGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供通用属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,获取书籍</span>
        <span class="token comment"># book = BookInfo.objects.get(id=book_id)</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#根据book_id到queryset中取出书籍对象</span>

        <span class="token comment">#2,创建序列化器对象</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>

        <span class="token comment">#4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,获取数据,获取对象</span>
        data_dict <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#2,创建序列化器对象</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">,</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

        <span class="token comment">#3,校验,入库</span>
        serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_201_CREATED<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,删除书籍</span>
        self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#2,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_204_NO_CONTENT<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_11-get-object方法" tabindex="-1">11,get_object方法 <a class="header-anchor" href="#_11-get-object方法" aria-hidden="true">#</a></h4><ul><li><p>目的: 理解get_object如何根据pk在queryset获取的单个对象</p></li><li><p>二级视图GenericAPIView属性方法总结</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
特点: 
1, GenericAPIView,继承自APIView类，为列表视图, 和详情视图,添加了常用的行为和属性。
    行为(方法)
        get_queryset:  获取queryset的数据集
        get_serializer: 获取serializer_class序列化器对象
        get_object:    根据lookup_field获取单个对象
    
    属性
        queryset:   通用的数据集
        serializer_class: 通用的序列化器
        lookup_field:   默认是pk,可以手动修改id

2, 可以和一个或多个mixin类配合使用。
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ul></li><li><p>操作流程:</p><ul><li><p>1, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookDetailGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供通用属性</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    lookup_field <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,获取书籍</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#根据id到queryset中取出书籍对象</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,获取数据,获取对象</span>
				<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#1,删除书籍</span>
        self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_12-mixin" tabindex="-1">12,MiXin <a class="header-anchor" href="#_12-mixin" aria-hidden="true">#</a></h4><ul><li><p>目的: 知道mixin的作用, 常见的mixin类</p></li><li><p>操作流程:</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
Mixin,特点: 
1, mixin类提供用于提供基本视图行为(列表视图, 详情视图)的操作--增删改查
2, 配合二级视图GenericAPIView使用的

类名称                 提供方法        功能
ListModelMixin        list          查询所有的数据
CreateModelMixin      create        创建单个对象
RetrieveModelMixin    retrieve      获取单个对象
UpdateModelMixin      update        更新单个对象
DestroyModelMixin     destroy       删除单个对象

&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li></ul><h4 id="_13-二级视图-mixin配合使用" tabindex="-1">13,二级视图,MiXin配合使用 <a class="header-anchor" href="#_13-二级视图-mixin配合使用" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用mixin和二级视图GenericAPIView对列表视图和详情视图做改写</p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^mixin_generic_apiview_books/$&#39;</span><span class="token punctuation">,</span>
        views<span class="token punctuation">.</span>BookListMixinGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
    url<span class="token punctuation">(</span><span class="token string">r&#39;^mixin_generic_apiview_books/(?P&lt;book_id&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>
        views<span class="token punctuation">.</span>BookDetailMixinGenericAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li></li></ul></li><li><p>2,类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>mixins <span class="token keyword">import</span> ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>DestroyModelMixin
<span class="token comment">#8,mixin和二级视图GenericAPIView, 实现列表视图, 详情视图</span>
<span class="token keyword">class</span> <span class="token class-name">BookListMixinGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">,</span>ListModelMixin<span class="token punctuation">,</span>CreateModelMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供公共的属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>create<span class="token punctuation">(</span>request<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">BookDetailMixinGenericAPIView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">,</span>RetrieveModelMixin<span class="token punctuation">,</span>UpdateModelMixin<span class="token punctuation">,</span>DestroyModelMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供通用属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer
    <span class="token comment"># lookup_field = &quot;id&quot;</span>
    lookup_url_kwarg <span class="token operator">=</span> <span class="token string">&quot;book_id&quot;</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>update<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>book_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div></li></ul></li></ul></li></ul><h2 id="三级视图与视图集" tabindex="-1">三级视图与视图集 <a class="header-anchor" href="#三级视图与视图集" aria-hidden="true">#</a></h2><h4 id="_14-三级视图" tabindex="-1">14,三级视图 <a class="header-anchor" href="#_14-三级视图" aria-hidden="true">#</a></h4><ul><li><p>目的: 知道三级视图的作用, 以及常见的三级视图</p></li><li><p>操作流程:</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
特点:
如果没有大量自定义的行为, 可以使用通用视图(三级视图)解决

常见的三级视图:
类名称                 父类              提供方法        作用
CreateAPIView       GenericAPIView，   post           创建单个对象
                    CreateModelMixin
                    
ListAPIView         GenericAPIView,    get            查询所有的数据
                    ListModelMixin

RetrieveAPIView     GenericAPIView,    get            获取单个对象
                    RetrieveModelMixin 
                    
DestroyAPIView      GenericAPIView,    delete         删除单个对象
                    DestroyModelMixin
                    
UpdateAPIView       GenericAPIView,    put            更新单个对象
                    UpdateModelMixin             


&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li></ul></li></ul><h4 id="_15-三级视图-实现列表-详情视图" tabindex="-1">15,三级视图,实现列表,详情视图 <a class="header-anchor" href="#_15-三级视图-实现列表-详情视图" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用三级视图实现列表视图,详情视图功能</p></li><li><p>操作流程:</p><ul><li><p>1,子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^third_view/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookListThirdView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r&#39;^third_view/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>
        views<span class="token punctuation">.</span>BookDetailThirdView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li><li><p>2,类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#10,三级视图,实现列表,详情视图</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> ListAPIView<span class="token punctuation">,</span>CreateAPIView
<span class="token keyword">class</span> <span class="token class-name">BookListThirdView</span><span class="token punctuation">(</span>ListAPIView<span class="token punctuation">,</span>CreateAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供公共的属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer

<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> RetrieveAPIView<span class="token punctuation">,</span>UpdateAPIView<span class="token punctuation">,</span>DestroyAPIView
<span class="token keyword">class</span> <span class="token class-name">BookDetailThirdView</span><span class="token punctuation">(</span>RetrieveAPIView<span class="token punctuation">,</span>UpdateAPIView<span class="token punctuation">,</span>DestroyAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,提供通用属性</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_16-视图集" tabindex="-1">16,视图集 <a class="header-anchor" href="#_16-视图集" aria-hidden="true">#</a></h4><blockquote><p>就是比如你获取单个，以及获取所有使用的都是get()方法，这时候就不能把这两个方法写在一个类之中，所以这就是viewset需要解决的问题；</p></blockquote><ul><li><p>目的: 知道视图集的作用, 以及常见的视图集</p></li><li><p>操作流程:</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
视图集
特点:
    1,可以将一组相关的操作, 放在一个类中进行完成
    2,不提供get,post方法, 使用retrieve, create方法来替代
    3,可以将标准的请求方式(get,post,put,delete), 和mixin中的方法做映射
    
常见的视图集:
类名称                 父类              作用
ViewSet               APIView          可以做路由映射（没有其他什么用）
                      ViewSetMixin（提供路由映射）		
                      
GenericViewSet        GenericAPIView   可以做路由映射,可以使用三个属性,三个方法
                      ViewSetMixin
                             
ModelViewSet          GenericAPIView   所有的增删改查功能,可以使用三个属性,三个方法
                      5个mixin类

ReadOnlyModelViewSet  GenericAPIView   获取单个,所有数据,可以使用三个属性,三个方法
                      RetrieveModelMixin
                      ListModelMixin

&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li></ul></li></ul><h4 id="_17-viewset" tabindex="-1">17,ViewSet <a class="header-anchor" href="#_17-viewset" aria-hidden="true">#</a></h4><blockquote><p>需要注意这里路由的映射；</p></blockquote><ul><li><p>目的: 可以使用ViewSet实现获取所有,单个数据</p><blockquote><p>如果不用viewset，一个视图类里面是无法使用两个get方法的</p></blockquote></li><li><p>操作流程:</p><ul><li><p>1,子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^viewset/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BooksViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;list&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r&#39;^viewset/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BooksViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;retrieve&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul></li><li><p>2,类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#12, 使用viewset实现获取所有和单个</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> get_object_or_404
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>serializer <span class="token keyword">import</span> BookInfoModelSerializer
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets

<span class="token keyword">class</span> <span class="token class-name">BooksViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    A simple ViewSet for listing or retrieving books.
    &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> BookInfoModelSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>queryset<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        book <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> BookInfoModelSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_18-readonlymodelviewset" tabindex="-1">18,ReadOnlyModelViewSet <a class="header-anchor" href="#_18-readonlymodelviewset" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以使用ReadOnlyModelViewSet获取所有, 和单个数据</p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^readonly_viewset/$&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>BooksReadOnlyModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;list&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
    url<span class="token punctuation">(</span><span class="token string">r&#39;^readonly_viewset/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>BooksReadOnlyModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;retrieve&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#13,使用ReadOnlyModelViewSet实现获取单个和所有</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ReadOnlyModelViewSet
<span class="token keyword">class</span> <span class="token class-name">BooksReadOnlyModelViewSet</span><span class="token punctuation">(</span>ReadOnlyModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_19-modelviewset" tabindex="-1">19,ModelViewSet <a class="header-anchor" href="#_19-modelviewset" aria-hidden="true">#</a></h4><ul><li><p>目的: 使用ModelViewSet实现列表视图,详情视图功能</p></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^model_viewset/$&#39;</span><span class="token punctuation">,</span> 
        views<span class="token punctuation">.</span>BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;list&#39;</span><span class="token punctuation">,</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;create&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
    url<span class="token punctuation">(</span><span class="token string">r&#39;^model_viewset/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span> 
        views<span class="token punctuation">.</span>BookModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;retrieve&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;put&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;update&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;delete&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;destroy&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#14,ModelViewSet实现列表视图,详情视图功能</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">class</span> <span class="token class-name">BookModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul></li></ul><h2 id="视图集额外动作" tabindex="-1">视图集额外动作 <a class="header-anchor" href="#视图集额外动作" aria-hidden="true">#</a></h2><h4 id="_1-视图集额外动作" tabindex="-1">1,视图集额外动作 <a class="header-anchor" href="#_1-视图集额外动作" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以给视图集添加额外的动作(方法)</p><blockquote><p>不修改原有的方法，但需要自定义自己的方法：比如查出阅读量大于20的书籍</p><p>原理：就是把自己自定义的方法与get或其他做一个映射就可以了</p></blockquote></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookInfoModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;create&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookInfoModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;retrieve&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;put&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;delete&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;destory&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/bread/$&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookInfoModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;bread_book&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>viewsets <span class="token keyword">import</span> ModelViewSet
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoModelSerializer
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer

    <span class="token comment">#1,获取阅读量大于20的书籍</span>
    <span class="token keyword">def</span> <span class="token function">bread_book</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,获取指定书籍</span>
        books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>bread__gt<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>

        <span class="token comment">#2,创建序列化器对象</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>books<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token comment">#3,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token comment">#2,修改书籍编号为1的, 阅读量为99</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li></ul></li><li><p>3, 序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo

<span class="token comment">#1,模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> BookInfo
        fields <span class="token operator">=</span> <span class="token string">&quot;__all__&quot;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_2-视图集额外动作-partial" tabindex="-1">2,视图集额外动作,partial <a class="header-anchor" href="#_2-视图集额外动作-partial" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以编写额外动作添加参数, 并且更新局部信息</p><blockquote><p>比如只传bread:99去修改就会报错，加上这个字段就不会报错</p></blockquote></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code>    url<span class="token punctuation">(</span><span class="token string">r&#39;^books/bread/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="token punctuation">,</span>
     views<span class="token punctuation">.</span>BookInfoModelViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;put&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;update_book_bread&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li><li><p>2, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#2,修改书籍编号为1的, 阅读量为99</span>
    <span class="token keyword">def</span> <span class="token function">update_book_bread</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#1,获取参数</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data

        <span class="token comment">#2,创建序列化器,partial=True可以局部更新</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>partial<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token comment">#3,校验,入库</span>
        serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#4,返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>status<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul></li></ul></li></ul><h2 id="router" tabindex="-1">router <a class="header-anchor" href="#router" aria-hidden="true">#</a></h2><h4 id="_3-路由router" tabindex="-1">3,路由router <a class="header-anchor" href="#_3-路由router" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以通过DefaultRouter和SimpleRouter两个类来自动生成路由</p></li><li><p>DefautRouter生成路由格式:</p><ul><li><p>特点: 共有三对路由</p><ul><li>1, 列表路由</li><li>2, 详情路由</li><li>3, 根路由</li></ul></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token punctuation">[</span>

<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span><span class="token builtin">list</span> <span class="token operator">^</span>books<span class="token operator">/</span>$<span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span><span class="token builtin">list</span> <span class="token operator">^</span>books\<span class="token punctuation">.</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span><span class="token builtin">format</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>a<span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">/</span>?$<span class="token operator">&gt;</span><span class="token punctuation">,</span>

<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span>detail <span class="token operator">^</span>books<span class="token operator">/</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span>pk<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">^</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">/</span>$<span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span>detail <span class="token operator">^</span>books<span class="token operator">/</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span>pk<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">^</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span><span class="token builtin">format</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>a<span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">/</span>?$<span class="token operator">&gt;</span><span class="token punctuation">,</span> 

<span class="token operator">&lt;</span>RegexURLPattern api<span class="token operator">-</span>root <span class="token operator">^</span>$<span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token operator">&lt;</span>RegexURLPattern api<span class="token operator">-</span>root <span class="token operator">^</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span><span class="token builtin">format</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>a<span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">/</span>?$<span class="token operator">&gt;</span>

<span class="token punctuation">]</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li><li><p>SimpleRouter生成路由格式:</p><ul><li><p>特点: 生成两个路由</p><ul><li>1, 列表路由</li><li>2, 详情路由</li></ul></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token punctuation">[</span>
<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span><span class="token builtin">list</span> <span class="token operator">^</span>books<span class="token operator">/</span>$<span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token operator">&lt;</span>RegexURLPattern haha<span class="token operator">-</span>detail <span class="token operator">^</span>books<span class="token operator">/</span><span class="token punctuation">(</span>?P<span class="token operator">&lt;</span>pk<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">^</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">/</span>$<span class="token operator">&gt;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li></ul></li><li><p>操作流程:</p><ul><li><p>1, 子路由</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> SimpleRouter<span class="token punctuation">,</span>DefaultRouter
<span class="token comment">#1,创建路由对象</span>
router <span class="token operator">=</span> SimpleRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#2,注册视图集</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">&#39;books&#39;</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>BookInfoModelViewSet<span class="token punctuation">,</span>base_name<span class="token operator">=</span><span class="token string">&quot;haha&quot;</span><span class="token punctuation">)</span>
urlpatterns <span class="token operator">+=</span> router<span class="token punctuation">.</span>urls

<span class="token comment">#3,输出结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>urlpatterns<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li></ul></li><li><p>注意点:</p><ul><li>1, 使用DRF可以自动根据前端需要的类型, 返回对应格式的数据</li><li>2, 请求的时候在请求头中标记, Accept即可</li><li>3, 只有视图集,才能自动生成路由</li></ul></li></ul><h4 id="_4-装饰action" tabindex="-1">4,装饰action <a class="header-anchor" href="#_4-装饰action" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以通过action装饰方法, 自动生成路由</p></li><li><p>操作流程:</p><ul><li><p>1, 类视图</p></li><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action

<span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#1,获取阅读量大于20的书籍</span>
    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment">#生成路由规则: 前缀/方法名/</span>
    <span class="token keyword">def</span> <span class="token function">bread_book</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#2,修改书籍编号为1的, 阅读量为99</span>
    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;PUT&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#生成路由规则: 前缀/{pk}/方法名/</span>
    <span class="token keyword">def</span> <span class="token function">update_book_bread</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span>pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul></li></ul><h2 id="权限设置" tabindex="-1">权限设置 <a class="header-anchor" href="#权限设置" aria-hidden="true">#</a></h2><h4 id="_5-认证authentication" tabindex="-1">5,认证Authentication <a class="header-anchor" href="#_5-认证authentication" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考官方文档, 配置认证内容</p></li><li><p>操作流程:</p><ul><li><p>1, 全局配置(<a href="http://setteings.py" target="_blank" rel="noopener noreferrer">setteings.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># DRF配置信息</span>
REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">#1,全局认证</span>
    <span class="token string">&#39;DEFAULT_AUTHENTICATION_CLASSES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;rest_framework.authentication.BasicAuthentication&#39;</span><span class="token punctuation">,</span> <span class="token comment">#此身份验证方案使用HTTP基本身份验证,用于测试使用</span>
        <span class="token string">&#39;rest_framework.authentication.SessionAuthentication&#39;</span><span class="token punctuation">,</span> <span class="token comment">#自己服务器认证用户</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul></li><li><p>2, 局部配置(<a href="http://views.py" target="_blank" rel="noopener noreferrer">views.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#1,局部认证</span>
    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>SessionAuthentication<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul></li></ul></li><li><p>注意点:</p><ul><li>如果配置了全局和局部, 默认使用局部</li></ul></li></ul><h4 id="_6-权限permissions" tabindex="-1">6,权限Permissions <a class="header-anchor" href="#_6-权限permissions" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考官方文档, 配置权限内容</p></li><li><p>操作流程:</p><ul><li><p>1, 全局权限配置(<a href="http://settings.py" target="_blank" rel="noopener noreferrer">settings.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code>REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">#1,全局认证</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#2,全局权限</span>
    <span class="token string">&#39;DEFAULT_PERMISSION_CLASSES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token comment"># &#39;rest_framework.permissions.IsAuthenticated&#39;, #普通用户</span>
        <span class="token comment"># &#39;rest_framework.permissions.AllowAny&#39;, #所有用户</span>
        <span class="token string">&#39;rest_framework.permissions.IsAdminUser&#39;</span><span class="token punctuation">,</span> <span class="token comment">#管理员户</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul></li><li><p>2, 局部权限配置(<a href="http://views.py" target="_blank" rel="noopener noreferrer">views.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#1,局部认证</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#2,局部权限</span>
    <span class="token comment"># permission_classes = [AllowAny]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_7-限流throttling" tabindex="-1">7,限流Throttling <a class="header-anchor" href="#_7-限流throttling" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以通过配置, 限制不同用户的访问次数</p></li><li><p>操作流程:</p><ul><li><p>1, 全局配置</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># DRF配置信息</span>
REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">#1,全局认证</span>
    <span class="token string">&#39;DEFAULT_AUTHENTICATION_CLASSES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;rest_framework.authentication.BasicAuthentication&#39;</span><span class="token punctuation">,</span> <span class="token comment">#此身份验证方案使用HTTP基本身份验证,用于测试使用</span>
        <span class="token string">&#39;rest_framework.authentication.SessionAuthentication&#39;</span><span class="token punctuation">,</span> <span class="token comment">#自己服务器认证用户</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">#2,全局权限</span>
    <span class="token comment"># &#39;DEFAULT_PERMISSION_CLASSES&#39;: [</span>
    <span class="token comment">#     # &#39;rest_framework.permissions.IsAuthenticated&#39;, #普通用户</span>
    <span class="token comment">#     # &#39;rest_framework.permissions.AllowAny&#39;, #所有用户</span>
    <span class="token comment">#     &#39;rest_framework.permissions.IsAdminUser&#39;, #管理员户</span>
    <span class="token comment"># ],</span>

    <span class="token comment">#3,全局限流</span>
    <span class="token string">&#39;DEFAULT_THROTTLE_CLASSES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;rest_framework.throttling.AnonRateThrottle&#39;</span><span class="token punctuation">,</span> <span class="token comment">#匿名用户</span>
        <span class="token string">&#39;rest_framework.throttling.UserRateThrottle&#39;</span> <span class="token comment"># 认证用户</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&#39;DEFAULT_THROTTLE_RATES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;anon&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;2/minute&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;user&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;3/minute&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></li></ul></li><li><p>2, 局部配置</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoModelSerializer

    <span class="token comment">#1,局部认证</span>
    <span class="token comment"># authentication_classes = [SessionAuthentication]</span>

    <span class="token comment">#2,局部权限</span>
    <span class="token comment"># permission_classes = [AllowAny]</span>

    <span class="token comment">#3,局部限流</span>
    throttle_classes <span class="token operator">=</span> <span class="token punctuation">[</span>AnonRateThrottle<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_8-可选限流" tabindex="-1">8, 可选限流 <a class="header-anchor" href="#_8-可选限流" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以定义可选限流, 用在不同的类视图中</p></li><li><p>操作流程:</p><ul><li><p>1, 全局定义</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment"># DRF配置信息</span>
REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">#4,可选限流</span>
    <span class="token string">&#39;DEFAULT_THROTTLE_CLASSES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;rest_framework.throttling.ScopedRateThrottle&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&#39;DEFAULT_THROTTLE_RATES&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&#39;downloads&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;3/minute&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;uploads&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;5/minute&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul></li><li><p>2, 局部使用</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">TestView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    throttle_scope <span class="token operator">=</span> <span class="token string">&quot;uploads&quot;</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">&quot;testing....&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li></ul></li></ul><h2 id="url可选参数设置" tabindex="-1">url可选参数设置 <a class="header-anchor" href="#url可选参数设置" aria-hidden="true">#</a></h2><h4 id="_9-分页pagination" tabindex="-1">9,分页Pagination <a class="header-anchor" href="#_9-分页pagination" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考文档, 设置分页返回</p></li><li><p>操作流程:</p><ul><li><p>1, 全局配置</p><ul><li><div class="language-python line-numbers-mode"><pre><code>REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  
    <span class="token comment">#5,全局分页</span>
    <span class="token string">&#39;DEFAULT_PAGINATION_CLASS&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;rest_framework.pagination.LimitOffsetPagination&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;PAGE_SIZE&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li><li><p>2, 局部配置</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    
    <span class="token comment">#5,局部分页</span>
    <span class="token comment"># pagination_class = LimitOffsetPagination # ?limit=100 或者 ?offset=400&amp;limit=100</span>
    pagination_class <span class="token operator">=</span> PageNumberPagination <span class="token comment"># ?page=4</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_10-自定义分页类" tabindex="-1">10, 自定义分页类 <a class="header-anchor" href="#_10-自定义分页类" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以自定义类, 实现指定分页大小效果</p></li><li><p>操作流程:</p><ul><li><p>1, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#自定义分页对象</span>
<span class="token keyword">class</span> <span class="token class-name">MyPageNumberPagination</span><span class="token punctuation">(</span>PageNumberPagination<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#1,默认的大小</span>
    page_size <span class="token operator">=</span> <span class="token number">3</span>

    <span class="token comment">#2,前端可以指定页面大小</span>
    page_size_query_param <span class="token operator">=</span> <span class="token string">&#39;page_size&#39;</span>

    <span class="token comment">#3,页面的最大大小</span>
    max_page_size <span class="token operator">=</span> <span class="token number">5</span>


<span class="token comment">#1,视图集</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">#6,自定义分页对象</span>
    pagination_class <span class="token operator">=</span> MyPageNumberPagination <span class="token comment"># ?page=4 或者 ?page=4&amp;page_size=100</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_11-过滤filtering" tabindex="-1">11,过滤Filtering <a class="header-anchor" href="#_11-过滤filtering" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以根据文档配置,进行过滤数据获取</p></li><li><p>操作流程:</p><ul><li><p>1, 安装扩展django-filters</p><ul><li>pip install django-filter</li></ul></li><li><p>2, 注册子应用</p><ul><li><div class="language-"><pre><code>INSTALLED_APPS = [
    ...
    &#39;django_filters&#39;,
]
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li><li><p>3, 全局配置</p><ul><li><div class="language-python line-numbers-mode"><pre><code>REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">&#39;DEFAULT_FILTER_BACKENDS&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;django_filters.rest_framework.DjangoFilterBackend&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li><li><p>4, 全局配置(<a href="http://views.py" target="_blank" rel="noopener noreferrer">views.py</a>)</p><ul><li><div class="language-"><pre><code>class BookInfoModelViewSet(ModelViewSet):
	....
  #7,局部过滤
  filter_backends = [DjangoFilterBackend]
  filterset_fields = [&#39;id&#39;, &#39;btitle&#39;,&quot;is_delete&quot;]
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_12-排序orderingfilter" tabindex="-1">12,排序OrderingFilter <a class="header-anchor" href="#_12-排序orderingfilter" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考文档, 使用指定的字段进行排序</p></li><li><p>操作流程:</p><ul><li><p>1, 类视图</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">BookInfoModelViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token comment">#8,局部排序</span>
    filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>filters<span class="token punctuation">.</span>OrderingFilter<span class="token punctuation">]</span> <span class="token comment"># 导包路径: from rest_framework import filters</span>
    
    ordering_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;btitle&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;bread&#39;</span><span class="token punctuation">]</span> <span class="token comment">#查询格式: ?ordering=-bread,id</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li></ul></li></ul><h2 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-hidden="true">#</a></h2><h4 id="_13-异常处理exceptions" tabindex="-1">13,异常处理Exceptions <a class="header-anchor" href="#_13-异常处理exceptions" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考文档, 处理程序中的异常信息</p></li><li><p>操作流程:</p><ul><li><p>1, 定义自定义处理方法(booktest/my_exception.py)</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> exception_handler
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> DatabaseError

<span class="token keyword">def</span> <span class="token function">custom_exception_handler</span><span class="token punctuation">(</span>exc<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#1,调用系统方法,处理了APIException的异常,或者其子类异常</span>
    response <span class="token operator">=</span> exception_handler<span class="token punctuation">(</span>exc<span class="token punctuation">,</span> context<span class="token punctuation">)</span>

    <span class="token comment">#2,判断response是否有值</span>
    <span class="token keyword">if</span> response <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">&#39;status_code&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>status_code
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>exc<span class="token punctuation">,</span> DatabaseError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> Response<span class="token punctuation">(</span><span class="token string">&quot;数据库大出血&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> Response<span class="token punctuation">(</span><span class="token string">&quot;其他异常!&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> response
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul></li><li><p>2, 全局配置(<a href="http://settings.py" target="_blank" rel="noopener noreferrer">settings.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code>REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span>
  	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">&#39;EXCEPTION_HANDLER&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;booktest.my_exception.custom_exception_handler&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li><li><p>3, 测试(<a href="http://views.py" target="_blank" rel="noopener noreferrer">views.py</a>)</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">class</span> <span class="token class-name">TestView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># throttle_scope = &quot;uploads&quot;</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># raise DatabaseError(&quot;DatabaseError!!!&quot;)</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;报错了!!!&quot;</span><span class="token punctuation">)</span>
        <span class="token comment"># raise APIException(&quot;APIException!!!&quot;)</span>
        <span class="token comment"># raise ValidationError(&quot;ValidationError!!!&quot;)</span>

        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">&quot;testing....&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li></ul></li></ul><h4 id="_14-接口文档-了解" tabindex="-1">14,接口文档(了解) <a class="header-anchor" href="#_14-接口文档-了解" aria-hidden="true">#</a></h4><ul><li><p>目的: 可以参考文档, 配置后端数据的入口文档</p></li><li><p>操作流程:</p><ul><li><p>1,安装扩展</p><ul><li>pip install coreapi</li></ul></li><li><p>2, 根路由</p><ul><li>url(<strong>r&#39;^docs/&#39;</strong>, include_docs_urls(title=<strong>&#39;我的API文档&#39;</strong>))</li></ul></li><li><p>3, 修改字段说明信息</p><ul><li><p>模型类</p><ul><li>btitle = models.CharField(max_length=20, verbose_name=<strong>&#39;名称&#39;</strong>,help_text=<strong>&quot;书籍标题&quot;</strong>)</li></ul></li><li><p>序列化器</p><ul><li><div class="language-python line-numbers-mode"><pre><code><span class="token comment">#1,模型类序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">BookInfoModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&#39;bread&#39;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
                <span class="token string">&#39;help_text&#39;</span><span class="token punctuation">:</span><span class="token string">&quot;书籍阅读量&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li></ul></li></ul></li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/知识库/后端储备/Django进阶学习笔记" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Django进阶学习笔记</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/知识库/后端储备/Redis学习笔记" data-v-38ede35f><span class="text" data-v-38ede35f>Redis学习笔记</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"1d8dde93\",\"推荐_typescript.md\":\"d36b7b6a\",\"推荐_index.md\":\"abe76e33\",\"推荐_动态规划.md\":\"33e80a41\",\"推荐_散列表实现查找.md\":\"f756d3a5\",\"推荐_这道题原来可以用到js这么多知识点！.md\":\"bb5622f7\",\"推荐_都2022年了，还是得学圣杯布局与双飞翼布局.md\":\"90aaf8d1\",\"知识库_ai相关_tfidf计算的学习.md\":\"9590ff26\",\"知识库_ai相关_index.md\":\"3a66f3b5\",\"知识库_css相关_01都2022年了，还是得学圣杯布局与双飞翼布局.md\":\"464d08ca\",\"知识库_css相关_index.md\":\"a71bbada\",\"知识库_javascript_typescript.md\":\"b850d80a\",\"知识库_javascript_index.md\":\"e7ebe10c\",\"知识库_javascript_这道题原来可以用到js这么多知识点！.md\":\"249bf872\",\"知识库_ui组件库_index.md\":\"2bd6def9\",\"知识库_index.md\":\"af41836f\",\"知识库_前端框架_01vue3是如何运行的.md\":\"86cec4bb\",\"知识库_前端框架_02vue3编译器.md\":\"52e2bec2\",\"知识库_前端框架_03虚拟dom.md\":\"d224500e\",\"知识库_前端框架_04vue3-reactivity.md\":\"2649160c\",\"知识库_前端框架_05mini-vue.md\":\"3dfde9a0\",\"知识库_前端框架_06vue3其他.md\":\"4f2a3b66\",\"知识库_前端框架_index.md\":\"7afb1c04\",\"知识库_后端储备_drf学习笔记.md\":\"e5ebedbe\",\"知识库_后端储备_django进阶学习笔记.md\":\"89b929ac\",\"知识库_后端储备_redis学习笔记.md\":\"334694e3\",\"知识库_后端储备_index.md\":\"28a806b0\",\"知识库_数据相关_index.md\":\"67502efc\",\"知识库_算法与数据结构_01基础概念.md\":\"bbe4a723\",\"知识库_算法与数据结构_02线性表.md\":\"f9ba94a1\",\"知识库_算法与数据结构_03栈和队列.md\":\"8a0df086\",\"知识库_算法与数据结构_04数组.md\":\"a2a46c9f\",\"知识库_算法与数据结构_05树.md\":\"ab698d4d\",\"知识库_算法与数据结构_06图.md\":\"c28a2e10\",\"知识库_算法与数据结构_07查找.md\":\"4661eacb\",\"知识库_算法与数据结构_08排序.md\":\"a54d9537\",\"知识库_算法与数据结构_09散列表实现查找.md\":\"4af489c6\",\"知识库_算法与数据结构_10算法概述.md\":\"b0471211\",\"知识库_算法与数据结构_11递归与分治.md\":\"59726a7a\",\"知识库_算法与数据结构_12动态规划.md\":\"ec279dea\",\"知识库_算法与数据结构_13贪心算法.md\":\"2b41f907\",\"知识库_算法与数据结构_14回溯与分支界限.md\":\"4ca2577e\",\"知识库_算法与数据结构_index.md\":\"e2aa4fb8\",\"知识库_计算机基础知识_index.md\":\"c086ad1b\",\"知识库_计算机基础知识_操作系统内存分配模拟程序.md\":\"a3857a9a\",\"知识库_计算机基础知识_操作系统基础.md\":\"268c0b83\"}")</script>
    <script type="module" async src="/assets/app.0b1f5e83.js"></script>
    
  </body>
</html>